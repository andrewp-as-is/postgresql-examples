<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0057)http://www.postgresql.org/docs/9.3/static/sql-notify.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>PostgreSQL: Documentation: 9.3: NOTIFY</title>
    <style type="text/css" media="screen" title="Normal Text">@import url("/media/css/docs.css");</style>
    <link rel="alternate stylesheet" media="screen" href="./9.3  NOTIFY_files/docs_large.css" type="text/css" title="Large Text" disabled="">
    <script type="text/javascript" async="" src="./9.3  NOTIFY_files/ga.js"></script><script type="text/javascript" src="./9.3  NOTIFY_files/styleswitcher.js"></script>
    <script type="text/javascript" src="./9.3  NOTIFY_files/monospacefix.js"></script></head><body><pre id="monotest" style="display: none;">&nbsp;</pre><p id="paratest" style="display: none;">&nbsp;</p><style type="text/css" media="screen">#docContainer tt, #docContainer pre, #docContainer code{font-size: 1.2em;}</style>

    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1345454-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<div id="docHeader">
	<div id="docHeaderLogo">
		<a href="http://www.postgresql.org/" title="PostgreSQL"><img src="./9.3  NOTIFY_files/hdr_logo.png" width="206" height="80" alt="PostgreSQL"></a>
	</div>
</div>

<div id="docContainerWrap">
<div id="docContainer">
<div id="docNavSearchContainer">
<div id="docSearch">
	<form action="http://www.postgresql.org/search/" method="get">
	<div>
	<input type="hidden" name="u" value="/docs/9.3/">
	<label for="q">Search Documentation:&nbsp;</label><input type="text" id="q" name="q" size="20" onfocus="if( this.value==this.defaultValue ) this.value=&#39;&#39;;" value="Search"><input id="submit" type="submit" value="Search">
	</div>
	</form>
        <div id="docTextSize">Text Size: <a href="http://www.postgresql.org/docs/9.3/static/sql-notify.html#" onclick="setActiveStyleSheet(&#39;Normal Text&#39;); return false;" onkeypress="return false;" title="Normal Text Size">Normal</a> / <a href="http://www.postgresql.org/docs/9.3/static/sql-notify.html#" onclick="setActiveStyleSheet(&#39;Large Text&#39;); return false;" onkeypress="return false;" title="Large Text Size">Large</a></div>
</div>
<div id="docNav">
<a href="http://www.postgresql.org/" title="Home">Home</a> → <a href="http://www.postgresql.org/docs" title="Documentation">Documentation</a> → <a href="http://www.postgresql.org/docs/manuals" title="Manuals">Manuals</a> → <a href="http://www.postgresql.org/docs/9.3/static/index.html">PostgreSQL 9.3</a>
</div>
<div id="docVersions">

This page in other versions:

	
	
	<a href="http://www.postgresql.org/docs/9.2/static/sql-notify.html" title="This page in version 9.2">9.2</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/9.1/static/sql-notify.html" title="This page in version 9.1">9.1</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/9.0/static/sql-notify.html" title="This page in version 9.0">9.0</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/8.4/static/sql-notify.html" title="This page in version 8.4">8.4</a>
	



&nbsp;|&nbsp; Unsupported versions:

	
	
	<b>9.3</b>
	

	/
	
	<a href="http://www.postgresql.org/docs/8.3/static/sql-notify.html" title="This page in version 8.3" rel="nofollow">8.3</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/8.2/static/sql-notify.html" title="This page in version 8.2" rel="nofollow">8.2</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/8.1/static/sql-notify.html" title="This page in version 8.1" rel="nofollow">8.1</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/8.0/static/sql-notify.html" title="This page in version 8.0" rel="nofollow">8.0</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/7.4/static/sql-notify.html" title="This page in version 7.4" rel="nofollow">7.4</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/7.3/static/sql-notify.html" title="This page in version 7.3" rel="nofollow">7.3</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/7.2/static/sql-notify.html" title="This page in version 7.2" rel="nofollow">7.2</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/7.1/static/sql-notify.html" title="This page in version 7.1" rel="nofollow">7.1</a>
	

	/
	
	<a href="http://www.postgresql.org/docs/devel/static/sql-notify.html" title="This page in version devel" rel="nofollow">devel</a>
	


</div>
</div>

<div id="docContent">
<div class="NAVHEADER">
  <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
    <tbody><tr>
      <th colspan="5" align="center" valign="bottom"><a href="http://www.postgresql.org/docs/9.3/static/index.html">PostgreSQL 9.3beta2 Documentation</a></th>
    </tr>

    <tr>
      <td width="10%" align="left" valign="top"><a title="MOVE" href="http://www.postgresql.org/docs/9.3/static/sql-move.html" accesskey="P">Prev</a></td>

      <td width="10%" align="left" valign="top"><a href="http://www.postgresql.org/docs/9.3/static/sql-commands.html" accesskey="U">Up</a></td>

      <td width="60%" align="center" valign="bottom"></td>

      <td width="20%" align="right" valign="top"><a title="PREPARE" href="http://www.postgresql.org/docs/9.3/static/sql-prepare.html" accesskey="N">Next</a></td>
    </tr>
  </tbody></table>
  <hr class="c1" width="100%">
</div>

<h1><a name="SQL-NOTIFY" id="SQL-NOTIFY"></a>NOTIFY</h1>

<div class="REFNAMEDIV">
  <a name="AEN78527" id="AEN78527"></a>

  <h2>Name</h2>NOTIFY&nbsp;--&nbsp;generate a notification
</div>

<div class="REFSYNOPSISDIV">
  <a name="AEN78532" id="AEN78532"></a>

  <h2>Synopsis</h2>
  <pre class="SYNOPSIS">NOTIFY <tt class="REPLACEABLE c2">channel</tt> [ , <tt class="REPLACEABLE c2">payload</tt> ]
</pre>
</div>

<div class="REFSECT1">
  <a name="AEN78536" id="AEN78536"></a>

  <h2>Description</h2>

  <p>The <tt class="COMMAND">NOTIFY</tt> command sends a
  notification event together with an optional <span class="QUOTE">"payload"</span> string to each client application that
  has previously executed <tt class="COMMAND">LISTEN <tt class="REPLACEABLE c2">channel</tt></tt> for the specified channel name
  in the current database. Notifications are visible to all
  users.</p>

  <p><tt class="COMMAND">NOTIFY</tt> provides a simple interprocess
  communication mechanism for a collection of processes accessing
  the same <span class="PRODUCTNAME">PostgreSQL</span> database. A
  payload string can be sent along with the notification, and
  higher-level mechanisms for passing structured data can be built
  by using tables in the database to pass additional data from
  notifier to listener(s).</p>

  <p>The information passed to the client for a notification event
  includes the notification channel name, the notifying session's
  server process <acronym class="ACRONYM">PID</acronym>, and the
  payload string, which is an empty string if it has not been
  specified.</p>

  <p>It is up to the database designer to define the channel names
  that will be used in a given database and what each one means.
  Commonly, the channel name is the same as the name of some table
  in the database, and the notify event essentially means,
  <span class="QUOTE">"I changed this table, take a look at it to
  see what's new"</span>. But no such association is enforced by
  the <tt class="COMMAND">NOTIFY</tt> and <tt class="COMMAND">LISTEN</tt> commands. For example, a database designer
  could use several different channel names to signal different
  sorts of changes to a single table. Alternatively, the payload
  string could be used to differentiate various cases.</p>

  <p>When <tt class="COMMAND">NOTIFY</tt> is used to signal the
  occurrence of changes to a particular table, a useful programming
  technique is to put the <tt class="COMMAND">NOTIFY</tt> in a rule
  that is triggered by table updates. In this way, notification
  happens automatically when the table is changed, and the
  application programmer cannot accidentally forget to do it.</p>

  <p><tt class="COMMAND">NOTIFY</tt> interacts with SQL
  transactions in some important ways. Firstly, if a <tt class="COMMAND">NOTIFY</tt> is executed inside a transaction, the
  notify events are not delivered until and unless the transaction
  is committed. This is appropriate, since if the transaction is
  aborted, all the commands within it have had no effect, including
  <tt class="COMMAND">NOTIFY</tt>. But it can be disconcerting if
  one is expecting the notification events to be delivered
  immediately. Secondly, if a listening session receives a
  notification signal while it is within a transaction, the
  notification event will not be delivered to its connected client
  until just after the transaction is completed (either committed
  or aborted). Again, the reasoning is that if a notification were
  delivered within a transaction that was later aborted, one would
  want the notification to be undone somehow — but the server
  cannot <span class="QUOTE">"take back"</span> a notification once
  it has sent it to the client. So notification events are only
  delivered between transactions. The upshot of this is that
  applications using <tt class="COMMAND">NOTIFY</tt> for real-time
  signaling should try to keep their transactions short.</p>

  <p>If the same channel name is signaled multiple times from the
  same transaction with identical payload strings, the database
  server can decide to deliver a single notification only. On the
  other hand, notifications with distinct payload strings will
  always be delivered as distinct notifications. Similarly,
  notifications from different transactions will never get folded
  into one notification. Except for dropping later instances of
  duplicate notifications, <tt class="COMMAND">NOTIFY</tt>
  guarantees that notifications from the same transaction get
  delivered in the order they were sent. It is also guaranteed that
  messages from different transactions are delivered in the order
  in which the transactions committed.</p>

  <p>It is common for a client that executes <tt class="COMMAND">NOTIFY</tt> to be listening on the same notification
  channel itself. In that case it will get back a notification
  event, just like all the other listening sessions. Depending on
  the application logic, this could result in useless work, for
  example, reading a database table to find the same updates that
  that session just wrote out. It is possible to avoid such extra
  work by noticing whether the notifying session's server process
  <acronym class="ACRONYM">PID</acronym> (supplied in the
  notification event message) is the same as one's own session's
  <acronym class="ACRONYM">PID</acronym> (available from
  <span class="APPLICATION">libpq</span>). When they are the same,
  the notification event is one's own work bouncing back, and can
  be ignored.</p>
</div>

<div class="REFSECT1">
  <a name="AEN78568" id="AEN78568"></a>

  <h2>Parameters</h2>

  <div class="VARIABLELIST">
    <dl>
      <dt><tt class="REPLACEABLE c2">channel</tt></dt>

      <dd>
        <p>Name of the notification channel to be signaled (any
        identifier).</p>
      </dd>

      <dt><tt class="REPLACEABLE c2">payload</tt></dt>

      <dd>
        <p>The <span class="QUOTE">"payload"</span> string to be
        communicated along with the notification. This must be
        specified as a simple string literal. In the default
        configuration it must be shorter than 8000 bytes. (If
        binary data or large amounts of information need to be
        communicated, it's best to put it in a database table and
        send the key of the record.)</p>
      </dd>
    </dl>
  </div>
</div>

<div class="REFSECT1">
  <a name="AEN78582" id="AEN78582"></a>

  <h2>Notes</h2>

  <p>There is a queue that holds notifications that have been sent
  but not yet processed by all listening sessions. If this queue
  becomes full, transactions calling <tt class="COMMAND">NOTIFY</tt> will fail at commit. The queue is quite
  large (8GB in a standard installation) and should be sufficiently
  sized for almost every use case. However, no cleanup can take
  place if a session executes <tt class="COMMAND">LISTEN</tt> and
  then enters a transaction for a very long time. Once the queue is
  half full you will see warnings in the log file pointing you to
  the session that is preventing cleanup. In this case you should
  make sure that this session ends its current transaction so that
  cleanup can proceed.</p>

  <p>A transaction that has executed <tt class="COMMAND">NOTIFY</tt> cannot be prepared for two-phase
  commit.</p>

  <div class="REFSECT2">
    <a name="AEN78589" id="AEN78589"></a>

    <h3>pg_notify</h3>

    <p>To send a notification you can also use the function
    <tt class="LITERAL"><code class="FUNCTION">pg_notify</code>(<tt class="TYPE">text</tt>,
    <tt class="TYPE">text</tt>)</tt>. The function takes the
    channel name as the first argument and the payload as the
    second. The function is much easier to use than the <tt class="COMMAND">NOTIFY</tt> command if you need to work with
    non-constant channel names and payloads.</p>
  </div>
</div>

<div class="REFSECT1">
  <a name="AEN78599" id="AEN78599"></a>

  <h2>Examples</h2>

  <p>Configure and execute a listen/notify sequence from
  <span class="APPLICATION">psql</span>:</p>
  <pre class="PROGRAMLISTING">LISTEN virtual;
NOTIFY virtual;
Asynchronous notification "virtual" received from server process with PID 8448.
NOTIFY virtual, 'This is the payload';
Asynchronous notification "virtual" with payload "This is the payload" received from server process with PID 8448.

LISTEN foo;
SELECT pg_notify('fo' || 'o', 'pay' || 'load');
Asynchronous notification "foo" with payload "payload" received from server process with PID 14728.
</pre>
</div>

<div class="REFSECT1">
  <a name="AEN78604" id="AEN78604"></a>

  <h2>Compatibility</h2>

  <p>There is no <tt class="COMMAND">NOTIFY</tt> statement in the
  SQL standard.</p>
</div>

<div class="REFSECT1">
  <a name="AEN78608" id="AEN78608"></a>

  <h2>See Also</h2><a href="http://www.postgresql.org/docs/9.3/static/sql-listen.html">LISTEN</a>, <a href="http://www.postgresql.org/docs/9.3/static/sql-unlisten.html">UNLISTEN</a>
</div>

<div class="NAVFOOTER">
  <hr class="c1" width="100%">

  <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
    <tbody><tr>
      <td width="33%" align="left" valign="top"><a href="http://www.postgresql.org/docs/9.3/static/sql-move.html" accesskey="P">Prev</a></td>

      <td width="34%" align="center" valign="top"><a href="http://www.postgresql.org/docs/9.3/static/index.html" accesskey="H">Home</a></td>

      <td width="33%" align="right" valign="top"><a href="http://www.postgresql.org/docs/9.3/static/sql-prepare.html" accesskey="N">Next</a></td>
    </tr>

    <tr>
      <td width="33%" align="left" valign="top">MOVE</td>

      <td width="34%" align="center" valign="top"><a href="http://www.postgresql.org/docs/9.3/static/sql-commands.html" accesskey="U">Up</a></td>

      <td width="33%" align="right" valign="top">PREPARE</td>
    </tr>
  </tbody></table>
</div>

</div>

<div id="docComments">



</div>

<div id="docFooter">
    <a href="http://www.postgresql.org/about/privacypolicy">Privacy Policy</a> |
    <a href="http://www.postgresql.org/about/">About PostgreSQL</a><br>
Copyright © 1996-2013 The PostgreSQL Global Development Group
</div>
</div>
</div>


</body></html>